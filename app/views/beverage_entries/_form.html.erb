<div class="card mb-3 shadow mx-auto" style="max-width: 100%; background-color: lightgray;">
  <div class="mt-3 mx-auto text-center">
    <strong><%= title %></strong>
  </div>
  <div class="container-fluid mt-3 py-3">
    <%= form_with model: beverage_entry, local: true, data: { controller: "beverage-form" } do |f| %>
      
      <!-- Consumed At -->
      <div class="mb-3">
        <label class="form-label">Date & Time of Consumption</label>
        <%= f.datetime_local_field :consumed_at, class: "form-control", required: true %>
      </div>

      <!-- Category -->
      <div class="mb-3">
        <label class="form-label">Beverage Category</label>
        <%= f.select :category, BeverageEntry::CATEGORIES.keys.map { |type| [type, type] }, 
          { include_blank: true, selected: @beverage_entry&.category || (params[:action] == 'new' ? BeverageEntry::CATEGORIES.keys.first : nil) }, 
          class: "form-select", 
          data: { action: "change->beverage-form#updateSubcategories" }, 
          required: true %>
      </div>

      <!-- Subcategory -->
      <div class="mb-3">
        <label class="form-label">Subcategory</label>
        <%= f.select :subcategory, [], { include_blank: true }, class: "form-select", data: { beverage_form_target: "subcategory", selected_subcategory: f.object&.subcategory }, required: true %>
      </div>

      <!-- Quantity -->
      <div class="mb-3">
        <label class="form-label">Quantity</label>
        <div class="d-flex">
          <%= f.number_field :quantity, class: "form-control", required: true, min: 0 %>
          <%= f.select :quantity_unit, [["Cups", "cups"], ["Ounces", "oz"], ["Milliliters", "ml"], ["Liters", "l"]], { selected: beverage_entry.quantity_unit }, class: "form-select ms-2", required: true %>
        </div>
      </div>

      <!-- Temperature -->
      <div class="mb-3">
        <label class="form-label">Temperature</label>
        <%= f.range_field :temperature, in: 0..6, class: "form-range", data: { action: "input->beverage-form#updateTemperatureLabel", beverage_form_target: "temperatureSlider" }, value: BeverageEntry.temperatures[beverage_entry.temperature] %>
        <%= f.hidden_field :temperature, data: { beverage_form_target: "temperatureValue" }, value: beverage_entry.temperature %>
        <div data-beverage-form-target="temperatureLabel" class="text-center">
          <%= beverage_entry.temperature.present? ? "ðŸŒ¡ï¸ #{BeverageEntry.temperatures.key(beverage_entry.temperature)}" : "ðŸŒ¡ï¸ Room Temperature" %>
        </div>
        <div class="invalid-feedback">Please select a temperature.</div>
      </div>

      <!-- Additives -->
      <div class="mb-3">
        <label class="form-label">Additions</label>
        <% ["Sugar", "Milk", "Creamer", "Lemon", "Lime", "Honey", "Artificial Sweeteners", "Protein Powder", "Electrolyte Powder"].each do |additive| %>
          <div class="form-check">
        <%= f.check_box :additions, { multiple: true, class: "form-check-input" }, additive, nil %>
        <%= label_tag "beverage_entry_additions_#{additive}", additive, class: "form-check-label" %>
          </div>
        <% end %>
      </div>

      
      <!-- Photo Upload -->
      <div class="mb-3">
        <label class="form-label">Upload a Photo (Optional)</label>
        <%= f.file_field :photo, class: "form-control" %>
      </div>

      <!-- Submit -->
      <div class="mt-3 text-center">
        <%= f.submit submit_text, class: "btn btn-primary" %>
      </div>

    <% end %>
  </div>
</div>
